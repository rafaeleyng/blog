<!DOCTYPE html><html><head><meta charSet="utf-8"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="preload" href="https://fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic&amp;display=optional" as="style"/><title>Optimizing Assets in Jekyll-generated gh-pages</title><meta name="description" content="Rafael Eyng&#x27;s tech blog"/><meta name="language" content="en"/><meta name="content-language" content="en"/><meta name="author" content="Rafael Eyng"/><meta name="keywords" content="software, development, javascript, github, node, docker, blog"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="canonical" href="https://rafaeleyng.github.io/optimizing-assets-in-jekyll-generated-gh-pages"/><link rel="shortcut icon" href="/favicon.png" type="image/x-icon"/><link href="https://fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic&amp;display=optional" rel="stylesheet" type="text/css"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-154633858-1"></script><script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-154633858-1');
</script><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/e3df4b49983992d5046044aed1d5fcf0279c70fe_CSS.7b3f6175.chunk.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e3df4b49983992d5046044aed1d5fcf0279c70fe_CSS.7b3f6175.chunk.css"/><link rel="preload" href="/_next/static/glNGuxu-y2ipFcQ3DFqVc/pages/post.js" as="script"/><link rel="preload" href="/_next/static/glNGuxu-y2ipFcQ3DFqVc/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-9369c5c69dbf6d4912cb.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.03885e3762b811c06d48.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.2d46a4062a63030a7155.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-fd16d9fd7045bb52879a.js" as="script"/><link rel="preload" href="/_next/static/chunks/a1bc03cf.5784ec4ab76361fe4054.js" as="script"/><link rel="preload" href="/_next/static/chunks/e3df4b49983992d5046044aed1d5fcf0279c70fe.197645e3acd9f743bf4c.js" as="script"/><link rel="preload" href="/_next/static/chunks/e3df4b49983992d5046044aed1d5fcf0279c70fe_CSS.c4a6afef92e8dd991da1.js" as="script"/></head><body><div id="__next"><div class="container"><header class="site-header single-column"><a class="blog-title" href="/">Rafael Eyng&#x27;s Blog</a><nav class="blog-menu"><a target="_blank" rel="noopener" href="https://rafaeleyng.github.io/me">About</a><a target="_blank" rel="noopener" href="https://github.com/rafaeleyng/rafaeleyng.github.io">Github</a></nav></header></div><header class="page-header"><div class="container single-column"><h1>Optimizing Assets in Jekyll-generated gh-pages</h1><p class="post-meta"><time itemProp="datePublished" dateTime="2015-10-30">Oct 30, 2015</time></p></div></header><main class="container single-column"><section class="post"><span class="hidden" itemProp="publisher">Rafael Eyng</span><span class="hidden" itemProp="keywords"></span><article class="post-content" itemProp="articleBody"><h2>Jekyll + gh-pages</h2><p>If you have some static site generated with <a href="https://jekyllrb.com/">Jekyll</a>, chances are that you are hosting your site with Github <a href="https://help.github.com/articles/using-jekyll-with-pages/">gh-pages</a>.</p><p>gh-pages are awesome for their simplicity to host and deploy your static site, but they lack the ability to allow you customize your build process. Github won&#x27;t allow you to run arbitrary Jekyll plugins at their environment, because of security concerns.</p><p>In this post I&#x27;ve collected a bunch of techniques to optimize your assets at build time that you can use even when hosting your Jekyll site in gh-pages.</p><h2>Optimize HTML</h2><h3>Minify HTML with Compress</h3><p><a href="https://github.com/penibelst/jekyll-compress-html">Jekyll Compress HTML</a> is a Jekyll layout file that compresses HTML by removing unnecessary empty spaces characters and by removing <a href="http://www.w3.org/TR/html5/syntax.html#optional-tags">optional HTML tags</a>.</p><p>Is just a <a href="https://github.com/penibelst/jekyll-compress-html/blob/master/site/_layouts/compress.html">single HTML file</a> that you download and put inside your <code>_layouts</code> folder. Then you reference it by putting</p><pre><code>---
layout: compress
---</code></pre><p>in the front-matter of your default layout, or in your HTML files. You can also remove empty spaces from a JSON/XML file that you generate, using the same approach.</p><p>You can check how it&#x27;s done in <a href="https://github.com/codeheaven-io/codeheaven.io/commit/96187be6c5c96c4785243c9ebf194823f5db9a35">this commit</a>.</p><h2>Optimize CSS</h2><p>Jekyll natively supports Sass, so you can concatenate your files into a single bundle out-of-the-box. But only doing this won&#x27;t minify or inline your CSS.</p><h3>Inline CSS</h3><p>It is a good idea to inline the CSS that is used to render the above-the-fold content of your site. But if you&#x27;re running a simple blog or project page, probably your above-the-fold CSS is <em>all</em> of your CSS. So it might be a good idea to inline your whole CSS into a <code>&lt;style&gt;</code> tag in the head of your page. Specially if your HTML + inline CSS together are smaller that 14.6kb gzipped (gh-pages serves your site gzipped), because this is <a href="https://developers.google.com/speed/docs/insights/mobile?hl=en">how much data your client can receive in its first roundtrip to the server</a>.</p><p>To do this, you create a <code>inline.scss</code> file your <code>_includes</code> directory, and import whatever SCSS file you want to end up being inlined. Usually, will be as simple as importing a <code>main.scss</code> file (from your <code>_sass</code> directory):</p><pre><code>@import &quot;main&quot;;</code></pre><p>Then, we include this file inside a <code>&lt;style&gt;</code> tag in the head of the document, passing it through Jekyll&#x27;s built-in <a href="http://www.rubydoc.info/github/jekyll/jekyll/Jekyll/Filters:scssify">scssify</a> filter:</p><p>{% raw %}</p><pre><code>{% capture inline_css %}
  {% include inline.scss %}
{% endcapture %}
{{ inline_css | scssify }}</code></pre><p>{% endraw %}</p><p>You can check how it&#x27;s done in <a href="https://github.com/codeheaven-io/codeheaven.io/commit/12ed5810d2edf6a967154cd14ee77b69ccf25c7f">this commit</a>.</p><p>Of course you can choose to inline only a portion of your CSS and load a separate CSS file.</p><div><small>
This technique I learned at this [Kevin Sweet post](http://www.kevinsweet.com/inline-scss-jekyll-github-pages/).
</small></div><h3>Minify inline CSS</h3><p>Remember our friend Jekyll Compress HTML? If your CSS is inline, Compress will remove empty spaces, which is basically how CSS is minified.</p><h2>Optimize JS</h2><h3>Concatenate JS</h3><p>Let&#x27;s save some HTTP requests. Write all your JS in as many files you want and <code>include</code> all of them in a single file, and add a single <code>&lt;script&gt;</code> tag in your HTML requesting this file.</p><p>Jekyll&#x27;s <code>include</code> will only look at the <code>_includes</code> folder, so it you want to keep your JS files in a separate folder, use <a href="http://jekyllrb.com/docs/templates/"><code>include_relative</code></a>, which allows you to include relative to the file you are working on.</p><p>You can check how it&#x27;s done in <a href="https://github.com/CWISoftware/eventos/commit/b180160afb613287c50bcc2f8f411fc4fe0d6fe0">this commit</a>.</p><h3>Minify JS</h3><p>This is what I haven&#x27;t discovered yet how to do without a plugin. If you know, please tell me in the comments box bellow.</p><p>Jekyll Compress won&#x27;t do it: it only removes empty space, and that&#x27;s not how JS is minified. Besides, if you use a <code>//</code> for a comment, all of your code after that will be commented out.</p><h3>Inline JS</h3><p>A simple <code>include</code> or <code>include_relative</code> of your file inside a <code>&lt;script&gt;</code> tag will do it. But it <strong>won&#x27;t work</strong> with Jekyll Compress HTML, so pick which is better for your case.</p></article><div id="disqus_thread"></div><script type="text/javascript">
var disqus_config = function () {
  this.page.url = 'https://rafaeleyng.github.io/optimizing-assets-in-jekyll-generated-gh-pages';
  this.page.identifier = '/optimizing-assets-in-jekyll-generated-gh-pages';
};

(function() { // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = 'https://rafaeleyng.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></section></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"document":{"content":"\n## Jekyll + gh-pages\n\nIf you have some static site generated with [Jekyll](https://jekyllrb.com/), chances are that you are hosting your site with Github [gh-pages](https://help.github.com/articles/using-jekyll-with-pages/).\n\ngh-pages are awesome for their simplicity to host and deploy your static site, but they lack the ability to allow you customize your build process. Github won't allow you to run arbitrary Jekyll plugins at their environment, because of security concerns.\n\nIn this post I've collected a bunch of techniques to optimize your assets at build time that you can use even when hosting your Jekyll site in gh-pages.\n\n\n## Optimize HTML\n\n### Minify HTML with Compress\n\n[Jekyll Compress HTML](https://github.com/penibelst/jekyll-compress-html) is a Jekyll layout file that compresses HTML by removing unnecessary empty spaces characters and by removing [optional HTML tags](http://www.w3.org/TR/html5/syntax.html#optional-tags).\n\nIs just a [single HTML file](https://github.com/penibelst/jekyll-compress-html/blob/master/site/_layouts/compress.html) that you download and put inside your `_layouts` folder. Then you reference it by putting\n\n```\n---\nlayout: compress\n---\n```\n\nin the front-matter of your default layout, or in your HTML files. You can also remove empty spaces from a JSON/XML file that you generate, using the same approach.\n\nYou can check how it's done in [this commit](https://github.com/codeheaven-io/codeheaven.io/commit/96187be6c5c96c4785243c9ebf194823f5db9a35).\n\n## Optimize CSS\n\nJekyll natively supports Sass, so you can concatenate your files into a single bundle out-of-the-box. But only doing this won't minify or inline your CSS.\n\n### Inline CSS\n\nIt is a good idea to inline the CSS that is used to render the above-the-fold content of your site. But if you're running a simple blog or project page, probably your above-the-fold CSS is *all* of your CSS. So it might be a good idea to inline your whole CSS into a `\u003cstyle\u003e` tag in the head of your page. Specially if your HTML + inline CSS together are smaller that 14.6kb gzipped (gh-pages serves your site gzipped), because this is [how much data your client can receive in its first roundtrip to the server](https://developers.google.com/speed/docs/insights/mobile?hl=en).\n\nTo do this, you create a `inline.scss` file your `_includes` directory, and import whatever SCSS file you want to end up being inlined. Usually, will be as simple as importing a `main.scss` file (from your `_sass` directory):\n\n```\n@import \"main\";\n```\n\nThen, we include this file inside a `\u003cstyle\u003e` tag in the head of the document, passing it through Jekyll's built-in [scssify](http://www.rubydoc.info/github/jekyll/jekyll/Jekyll/Filters:scssify) filter:\n\n{% raw %}\n```\n{% capture inline_css %}\n  {% include inline.scss %}\n{% endcapture %}\n{{ inline_css | scssify }}\n```\n{% endraw %}\n\nYou can check how it's done in [this commit](https://github.com/codeheaven-io/codeheaven.io/commit/12ed5810d2edf6a967154cd14ee77b69ccf25c7f).\n\nOf course you can choose to inline only a portion of your CSS and load a separate CSS file.\n\n\u003csmall\u003e\nThis technique I learned at this [Kevin Sweet post](http://www.kevinsweet.com/inline-scss-jekyll-github-pages/).\n\u003c/small\u003e\n\n### Minify inline CSS\n\nRemember our friend Jekyll Compress HTML? If your CSS is inline, Compress will remove empty spaces, which is basically how CSS is minified.\n\n## Optimize JS\n\n### Concatenate JS\n\nLet's save some HTTP requests. Write all your JS in as many files you want and `include` all of them in a single file, and add a single `\u003cscript\u003e` tag in your HTML requesting this file.\n\nJekyll's `include` will only look at the `_includes` folder, so it you want to keep your JS files in a separate folder, use [`include_relative`](http://jekyllrb.com/docs/templates/), which allows you to include relative to the file you are working on.\n\nYou can check how it's done in [this commit](https://github.com/CWISoftware/eventos/commit/b180160afb613287c50bcc2f8f411fc4fe0d6fe0).\n\n### Minify JS\n\nThis is what I haven't discovered yet how to do without a plugin. If you know, please tell me in the comments box bellow.\n\nJekyll Compress won't do it: it only removes empty space, and that's not how JS is minified. Besides, if you use a `//` for a comment, all of your code after that will be commented out.\n\n### Inline JS\n\nA simple `include` or `include_relative` of your file inside a `\u003cscript\u003e` tag will do it. But it **won't work** with Jekyll Compress HTML, so pick which is better for your case.\n","data":{"title":"Optimizing Assets in Jekyll-generated gh-pages","date":"2015-10-31T00:28:39.000Z","excerpt":"Learn how to optimize assets for your Jekyll site without having to rely on plugins.\n"}},"slug":"optimizing-assets-in-jekyll-generated-gh-pages"}}},"page":"/post","query":{"slug":"optimizing-assets-in-jekyll-generated-gh-pages"},"buildId":"glNGuxu-y2ipFcQ3DFqVc","nextExport":true,"isFallback":false}</script><script nomodule="" src="/_next/static/runtime/polyfills-2998c20c30097f9c8a42.js"></script><script async="" data-next-page="/post" src="/_next/static/glNGuxu-y2ipFcQ3DFqVc/pages/post.js"></script><script async="" data-next-page="/_app" src="/_next/static/glNGuxu-y2ipFcQ3DFqVc/pages/_app.js"></script><script src="/_next/static/runtime/webpack-9369c5c69dbf6d4912cb.js" async=""></script><script src="/_next/static/chunks/framework.03885e3762b811c06d48.js" async=""></script><script src="/_next/static/chunks/commons.2d46a4062a63030a7155.js" async=""></script><script src="/_next/static/runtime/main-fd16d9fd7045bb52879a.js" async=""></script><script src="/_next/static/chunks/a1bc03cf.5784ec4ab76361fe4054.js" async=""></script><script src="/_next/static/chunks/e3df4b49983992d5046044aed1d5fcf0279c70fe.197645e3acd9f743bf4c.js" async=""></script><script src="/_next/static/chunks/e3df4b49983992d5046044aed1d5fcf0279c70fe_CSS.c4a6afef92e8dd991da1.js" async=""></script><script src="/_next/static/glNGuxu-y2ipFcQ3DFqVc/_buildManifest.js" async=""></script><script src="/_next/static/glNGuxu-y2ipFcQ3DFqVc/_ssgManifest.js" async=""></script></body></html>