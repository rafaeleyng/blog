<!DOCTYPE html><html><head><meta charSet="utf-8"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="preload" href="https://fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic&amp;display=optional" as="style"/><title>Using Nexus 3 as Your Repository - Part 2: Npm Packages</title><meta name="description" content="Rafael Eyng&#x27;s tech blog"/><meta name="language" content="en"/><meta name="content-language" content="en"/><meta name="author" content="Rafael Eyng"/><meta name="keywords" content="software, development, javascript, github, node, docker, blog"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="canonical" href="https://rafaeleyng.github.io/using-nexus-3-as-your-repository-part-2-npm-packages"/><link rel="shortcut icon" href="/favicon.png" type="image/x-icon"/><link href="https://fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic&amp;display=optional" rel="stylesheet" type="text/css"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-154633858-1"></script><script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-154633858-1');
</script><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/cf64dab97a0355ddac54e129c3acb55aff14938f_CSS.7b3f6175.chunk.css" as="style"/><link rel="stylesheet" href="/_next/static/css/cf64dab97a0355ddac54e129c3acb55aff14938f_CSS.7b3f6175.chunk.css"/><link rel="preload" href="/_next/static/dEkFoDhXLch93PZLjykdg/pages/post.js" as="script"/><link rel="preload" href="/_next/static/dEkFoDhXLch93PZLjykdg/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-9369c5c69dbf6d4912cb.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.03885e3762b811c06d48.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.2d46a4062a63030a7155.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-fd16d9fd7045bb52879a.js" as="script"/><link rel="preload" href="/_next/static/chunks/a1bc03cf.5784ec4ab76361fe4054.js" as="script"/><link rel="preload" href="/_next/static/chunks/cf64dab97a0355ddac54e129c3acb55aff14938f.1f2abe620427fc640b4f.js" as="script"/><link rel="preload" href="/_next/static/chunks/cf64dab97a0355ddac54e129c3acb55aff14938f_CSS.c4a6afef92e8dd991da1.js" as="script"/></head><body><div id="__next"><div class="container"><header class="site-header single-column"><a class="blog-title" href="/">Rafael Eyng&#x27;s Blog</a><nav class="blog-menu"><a target="_blank" rel="noopener" href="https://rafaeleyng.github.io/me">About</a><a target="_blank" rel="noopener" href="https://github.com/rafaeleyng/rafaeleyng.github.io">Github</a></nav></header></div><header class="page-header"><div class="container single-column"><h1>Using Nexus 3 as Your Repository - Part 2: Npm Packages</h1><p class="post-meta"><time itemProp="datePublished" dateTime="2016-12-03">Dec 3, 2016</time></p></div></header><main class="container single-column"><section class="post"><span class="hidden" itemProp="publisher">Rafael Eyng</span><span class="hidden" itemProp="keywords">nexus, repository, private, proxy, npm</span><article class="post-content" itemProp="articleBody"><div><small>
This is the second part of a series of posts on Nexus 3 and how to use it as repository for several technologies.
</small></div><p><code>npm install</code> can take too long sometimes, so it might be a good idea to have a proxy in your own network. And if you can&#x27;t just pay the 7 dollars/month to host your packages in the official npm private registry, then you&#x27;ll probably benefit from this post.</p><h2>Installation</h2><p>Check out the <a href="https://rafaeleyng.github.io/using-nexus-3-as-your-repository-part-1-maven-artifacts/">first part</a> of this series to see how we installed and ran Nexus 3 using a single docker command. Just do that and the installation is done.</p><h2>Configuring Nexus as a npm repo</h2><p>What we will do:</p><ul><li>create a private (hosted) repository for our own packages</li><li>create a proxy repository pointing to the official registry</li><li>create a group repository to provide all the above repos under a single URL</li></ul><p>I suggest you to create a new blob store for each new repo you want to create. That way, the data for every repo will be in a different folder in <code>/nexus-data</code> (inside the Docker container). But this is not mandatory for it to work.</p><h3>private repo</h3><p>A repository for npm packages that your team develops.</p><p>Create a new npm (hosted) repository and configure it like:</p><p><img alt="npm-private0" src="https://cloud.githubusercontent.com/assets/4842605/20909966/d6f8101e-bb45-11e6-9791-0f2472866fdd.png"/></p><p>The deployment policy &quot;Allow redeploy&quot; above might look somewhat polemic, so you might want to set it to &quot;Disable redeploy&quot;. In my use case, it makes sense to use &quot;Allow redeploy&quot;, since we keep a <code>latest</code> version on Nexus always updated with the status of the master branch, that is redeployed in our CI flow.</p><h3>proxy repo</h3><p>A repository that proxies everything you download from the official npm registry. Next time you download the same dependency, it will be cached in your Nexus.</p><p>Create a new npm (proxy) repository and configure it like:</p><p><img alt="npm-registry0" src="https://cloud.githubusercontent.com/assets/4842605/20909964/d6f6568e-bb45-11e6-9161-6e302ed1757f.png"/></p><p><img alt="npm-registry1" src="https://cloud.githubusercontent.com/assets/4842605/20909965/d6f7e9ea-bb45-11e6-86f1-c6ce957bf948.png"/></p><h3>group repo</h3><p>This will group all the above repos and provide you a single URL to configure your clients to download from/deploy to.</p><p>Create a new npm (group) repository and configure it like:</p><p><img alt="npm-group0" src="https://cloud.githubusercontent.com/assets/4842605/20909963/d6f41e32-bb45-11e6-9134-848409b5d781.png"/></p><p>You can create as many repos as you need and group them all in the group repo, but for npm I don&#x27;t think that you will need more than 1 proxy and 1 private repos.</p><h2>Configuring your clients and projects to use your Nexus repos</h2><p>For npm, we will configure the repository per project (unlike Maven, that have some global configs, for instance). I believe that you can configure the authentication globally in your machine, with <code>npm addUser</code>, but I didn&#x27;t went that way for simplicity.</p><p>If you have a project where you only want to <strong>download</strong> dependencies from Nexus, create a <code>.npmrc</code> file at your project&#x27;s root with:</p><pre><code>registry=http://your-host:8081/repository/npm-group/
_auth=YWRtaW46YWRtaW4xMjM=</code></pre><p><code>_auth=YWRtaW46YWRtaW4xMjM=</code> is the base64 hash for the credentials (admin/admin123). If you use a different set of credentials, you should compute your own hash with:</p><pre><code>echo -n &#x27;myuser:mypassword&#x27; | openssl base64</code></pre><p>You have to set a user so you can publish packages. If you do this from your local machine, <code>npm publish</code> will use your user configured in <code>~/.npmrc</code> (in your home, not in your project). If you don&#x27;t have this configuration, or if you want to publish from CI, you can set an <code>email=any@email.com</code> configuration in your project&#x27;s <code>.npmrc</code>. Really, any email.</p><p>If you have a project that you want to <strong>publish</strong> to your Nexus, put this in <code>package.json</code>:</p><pre><code>{
  ...

  &quot;publishConfig&quot;: {
    &quot;registry&quot;: &quot;http://your-host:8081/repository/npm-private/&quot;
  }
}</code></pre><p>Note that you publish to your private repo, but when you download, you can point to your group repo, so both your own packages and the packages from the official repo will be available from a single URL.</p><p>Now if you run in your projects:</p><pre><code>npm install
# or
npm publish</code></pre><p>your <code>npm</code> will point to your Nexus instance.</p><h2>Installing npm packages globally</h2><p>Run:</p><pre><code>npm --registry http://your-host:8081/repository/npm-group/ install -g your-package</code></pre></article><div id="disqus_thread"></div><script type="text/javascript">
var disqus_config = function () {
  this.page.url = 'https://rafaeleyng.github.io/using-nexus-3-as-your-repository-part-2-npm-packages';
  this.page.identifier = '/using-nexus-3-as-your-repository-part-2-npm-packages';
};

(function() { // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = 'https://rafaeleyng.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></section></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"document":{"content":"\n\u003csmall\u003e\nThis is the second part of a series of posts on Nexus 3 and how to use it as repository for several technologies.\n\u003c/small\u003e\n\n`npm install` can take too long sometimes, so it might be a good idea to have a proxy in your own network. And if you can't just pay the 7 dollars/month to host your packages in the official npm private registry, then you'll probably benefit from this post.\n\n## Installation\n\nCheck out the [first part](https://rafaeleyng.github.io/using-nexus-3-as-your-repository-part-1-maven-artifacts/) of this series to see how we installed and ran Nexus 3 using a single docker command. Just do that and the installation is done.\n\n## Configuring Nexus as a npm repo\n\nWhat we will do:\n  - create a private (hosted) repository for our own packages\n  - create a proxy repository pointing to the official registry\n  - create a group repository to provide all the above repos under a single URL\n\nI suggest you to create a new blob store for each new repo you want to create. That way, the data for every repo will be in a different folder in `/nexus-data` (inside the Docker container). But this is not mandatory for it to work.\n\n### private repo\n\nA repository for npm packages that your team develops.\n\nCreate a new npm (hosted) repository and configure it like:\n\n![npm-private0](https://cloud.githubusercontent.com/assets/4842605/20909966/d6f8101e-bb45-11e6-9791-0f2472866fdd.png)\n\nThe deployment policy \"Allow redeploy\" above might look somewhat polemic, so you might want to set it to \"Disable redeploy\". In my use case, it makes sense to use \"Allow redeploy\", since we keep a `latest` version on Nexus always updated with the status of the master branch, that is redeployed in our CI flow.\n\n### proxy repo\n\nA repository that proxies everything you download from the official npm registry. Next time you download the same dependency, it will be cached in your Nexus.\n\nCreate a new npm (proxy) repository and configure it like:\n\n![npm-registry0](https://cloud.githubusercontent.com/assets/4842605/20909964/d6f6568e-bb45-11e6-9161-6e302ed1757f.png)\n\n![npm-registry1](https://cloud.githubusercontent.com/assets/4842605/20909965/d6f7e9ea-bb45-11e6-86f1-c6ce957bf948.png)\n\n### group repo\n\nThis will group all the above repos and provide you a single URL to configure your clients to download from/deploy to.\n\nCreate a new npm (group) repository and configure it like:\n\n![npm-group0](https://cloud.githubusercontent.com/assets/4842605/20909963/d6f41e32-bb45-11e6-9134-848409b5d781.png)\n\nYou can create as many repos as you need and group them all in the group repo, but for npm I don't think that you will need more than 1 proxy and 1 private repos.\n\n## Configuring your clients and projects to use your Nexus repos\n\nFor npm, we will configure the repository per project (unlike Maven, that have some global configs, for instance). I believe that you can configure the authentication globally in your machine, with `npm addUser`, but I didn't went that way for simplicity.\n\nIf you have a project where you only want to **download** dependencies from Nexus, create a `.npmrc` file at your project's root with:\n\n```\nregistry=http://your-host:8081/repository/npm-group/\n_auth=YWRtaW46YWRtaW4xMjM=\n```\n\n`_auth=YWRtaW46YWRtaW4xMjM=` is the base64 hash for the credentials (admin/admin123). If you use a different set of credentials, you should compute your own hash with:\n\n```\necho -n 'myuser:mypassword' | openssl base64\n```\n\nYou have to set a user so you can publish packages. If you do this from your local machine, `npm publish` will use your user configured in `~/.npmrc` (in your home, not in your project). If you don't have this configuration, or if you want to publish from CI, you can set an `email=any@email.com` configuration in your project's `.npmrc`. Really, any email.\n\nIf you have a project that you want to **publish** to your Nexus, put this in `package.json`:\n\n```\n{\n  ...\n\n  \"publishConfig\": {\n    \"registry\": \"http://your-host:8081/repository/npm-private/\"\n  }\n}\n```\n\nNote that you publish to your private repo, but when you download, you can point to your group repo, so both your own packages and the packages from the official repo will be available from a single URL.\n\nNow if you run in your projects:\n\n```\nnpm install\n# or\nnpm publish\n```\n\nyour `npm` will point to your Nexus instance.\n\n## Installing npm packages globally\n\nRun:\n\n```\nnpm --registry http://your-host:8081/repository/npm-group/ install -g your-package\n```\n","data":{"title":"Using Nexus 3 as Your Repository - Part 2: Npm Packages","date":"2016-12-03T21:31:27.000Z","keywords":"nexus, repository, private, proxy, npm","excerpt":"In this second post of the series, I'll show you how to setup Nexus 3 and configure it to use it as a private npm registry and as a proxy to the official registry.\n"}},"slug":"using-nexus-3-as-your-repository-part-2-npm-packages"}}},"page":"/post","query":{"slug":"using-nexus-3-as-your-repository-part-2-npm-packages"},"buildId":"dEkFoDhXLch93PZLjykdg","nextExport":true,"isFallback":false}</script><script nomodule="" src="/_next/static/runtime/polyfills-2998c20c30097f9c8a42.js"></script><script async="" data-next-page="/post" src="/_next/static/dEkFoDhXLch93PZLjykdg/pages/post.js"></script><script async="" data-next-page="/_app" src="/_next/static/dEkFoDhXLch93PZLjykdg/pages/_app.js"></script><script src="/_next/static/runtime/webpack-9369c5c69dbf6d4912cb.js" async=""></script><script src="/_next/static/chunks/framework.03885e3762b811c06d48.js" async=""></script><script src="/_next/static/chunks/commons.2d46a4062a63030a7155.js" async=""></script><script src="/_next/static/runtime/main-fd16d9fd7045bb52879a.js" async=""></script><script src="/_next/static/chunks/a1bc03cf.5784ec4ab76361fe4054.js" async=""></script><script src="/_next/static/chunks/cf64dab97a0355ddac54e129c3acb55aff14938f.1f2abe620427fc640b4f.js" async=""></script><script src="/_next/static/chunks/cf64dab97a0355ddac54e129c3acb55aff14938f_CSS.c4a6afef92e8dd991da1.js" async=""></script><script src="/_next/static/dEkFoDhXLch93PZLjykdg/_buildManifest.js" async=""></script><script src="/_next/static/dEkFoDhXLch93PZLjykdg/_ssgManifest.js" async=""></script></body></html>